{% extends "components/_main.jinja" %}

{% block title %}Articles{% endblock %}

{% block main %}
<div class="card">
	<h2>Articles</h2>
	<p>Here are some short posts and examples you can read and reuse.</p>
	
	{% if articles %}
		<div style="display: flex; flex-direction: column; gap: 1.5rem; margin-top: 2rem;">
			{% for a in articles %}
				<div style="border: 1px solid var(--card-border); border-radius: 8px; padding: 1.25rem; background: var(--card); transition: transform 0.2s, box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
					<a href="{{ url_for('public.article_detail', slug=a.slug) }}" style="text-decoration: none; color: var(--text);">
						<h3 style="margin-bottom: 0.5rem; color: var(--cyan);">{{ a.title }}</h3>
					</a>
					
					{% if a.summary %}
						<p class="muted" style="margin-bottom: 0.75rem;">{{ a.summary }}</p>
					{% endif %}
					
					<div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; font-size: 0.9rem;">
						{% if a.author %}
							<div style="display: flex; align-items: center; gap: 0.4rem;">
								{% if a.author.profile_picture %}
									<img src="{{ url_for('static', filename='uploads/profiles/' + a.author.profile_picture) }}" 
										 alt="{{ a.author.username }}" 
										 style="width: 24px; height: 24px; border-radius: 50%; object-fit: cover;">
								{% else %}
									<div style="width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, var(--dark-purple), var(--blue)); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.75rem;">
										{{ a.author.username[0].upper() }}
									</div>
								{% endif %}
								<a href="{{ url_for('profile.view_profile', username=a.author.username) }}" style="color: var(--text); font-weight: 500;">
									{{ a.author.display_name or a.author.username }}
								</a>
							</div>
							<span class="muted">•</span>
						{% endif %}
						
						<span class="muted">{{ a.created_at[:10] }}</span>
						<span class="muted">•</span>
						<span class="muted"><i class="bi bi-chat-dots"></i> {{ a.comments_count }}</span>
						<span class="muted">•</span>
						<span class="muted"><i class="bi bi-heart-fill"></i> {{ a.likes_count }}</span>
					</div>
				</div>
			{% endfor %}
		</div>
	{% else %}
		<p class="muted">No articles available yet.</p>
	{% endif %}
	
	{% if pagination.pages > 1 %}
	<div class="pagination" style="margin-top: 2rem;">
		{% if pagination.has_prev %}
			<a href="{{ url_for('public.articles', page=pagination.prev_num) }}" class="page-link">&laquo; Previous</a>
		{% else %}
			<span class="page-link disabled">&laquo; Previous</span>
		{% endif %}
		
		{% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
			{% if page_num %}
				{% if page_num == pagination.page %}
					<span class="page-link active">{{ page_num }}</span>
				{% else %}
					<a href="{{ url_for('public.articles', page=page_num) }}" class="page-link">{{ page_num }}</a>
				{% endif %}
			{% else %}
				<span class="page-link disabled">...</span>
			{% endif %}
		{% endfor %}
		
		{% if pagination.has_next %}
			<a href="{{ url_for('public.articles', page=pagination.next_num) }}" class="page-link">Next &raquo;</a>
		{% else %}
			<span class="page-link disabled">Next &raquo;</span>
		{% endif %}
	</div>
	{% endif %}
	
	<p style="margin-top:1rem;"><a class="button" href="/">Back to Home</a></p>
</div>
{% endblock %}

